<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEN TOES ACADEMY</title>
    <link href="https://fonts.googleapis.com/css2?family=Chewy&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background-color: #000;
            color: #fff;
            overflow: hidden;
            height: 100vh;
            font-family: 'Chewy', cursive, sans-serif;
        }
        
        .container {
            position: relative;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
        }
        
        /* 首页样式 */
        .home-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('BG_DEMO1.png') no-repeat center center;
            background-size: cover;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            transition: filter 0.5s;
        }
        
        .logo-container {
            text-align: center;
            margin-bottom: 60px;
        }
        
        .main-title {
            font-size: 3.5rem;
            font-weight: normal;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        
        .sub-title {
            font-size: 1.8rem;
            font-weight: normal;
            letter-spacing: 1px;
            margin-bottom: 30px;
        }
        
        .event-title {
            font-size: 2.2rem;
            font-weight: normal;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .event-subtitle {
            font-size: 1.3rem;
            font-weight: normal;
            margin-bottom: 50px;
            text-align: center;
            max-width: 80%;
            line-height: 1.6;
        }
        
        .start-btn {
            background: #ff3366;
            color: white;
            border: none;
            padding: 15px 60px;
            font-size: 1.5rem;
            font-weight: normal;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 51, 102, 0.4);
            transition: all 0.3s ease;
            font-family: 'Chewy', cursive;
        }
        
        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 51, 102, 0.6);
        }
        
        .loading-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('BG_DEMO.png') no-repeat center center;
            background-size: cover;
            filter: blur(10px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 101;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #ff3366;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 1.2rem;
            color: #fff;
            font-family: 'Chewy', cursive;
        }
        
        /* 相机页面样式 */
        .camera-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            z-index: 90;
        }
        
        .camera-preview {
            position: relative;
            height: 70vh;
            overflow: hidden;
        }
        
        .preview-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 1;
        }
        
        .camera-feed {
            position: absolute;
            top: 5%;
            left: 5%;
            width: 90%;
            height: 90%;
            object-fit: cover;
            z-index: 2;
            border-radius: 10px;
            transform: scaleX(-1); /* 镜像效果 */
        }
        
        .frame-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain;
            z-index: 3;
            pointer-events: none;
        }
        
        .top-controls {
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 10;
        }
        
        .control-btn {
            width: 40px;
            height: 40px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .control-btn:hover {
            background: rgba(0, 0, 0, 0.7);
            transform: scale(1.1);
        }
        
        .control-btn img {
            width: 60%;
            height: 60%;
            filter: invert(1);
        }
        
        .style-selector {
            position: absolute;
            bottom: 160px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            z-index: 10;
        }
        
        .style-scroller {
            display: flex;
            overflow-x: auto;
            padding: 10px 0;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .style-scroller::-webkit-scrollbar {
            display: none;
        }
        
        .style-button {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            margin: 0 8px;
            flex-shrink: 0;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            background-size: cover;
            background-position: center;
            border: 2px solid transparent;
        }
        
        .style-button.active {
            width: 90px;
            height: 90px;
            border: 3px solid #ff3366;
            transform: translateY(-10px);
        }
        
        .capture-controls {
            position: absolute;
            bottom: 50px;
            left: 0;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 10;
        }
        
        .capture-button {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #ff3366;
            border: 5px solid rgba(255, 255, 255, 0.5);
            cursor: pointer;
            margin-bottom: 20px;
            position: relative;
            transition: all 0.2s;
        }
        
        .capture-button:active {
            transform: scale(0.95);
            background: #ff1a55;
        }
        
        .capture-button.video-recording::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            border: 3px solid #ff3366;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.8); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }
        
        .mode-bar {
            display: flex;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 30px;
            padding: 8px;
        }
        
        .mode-btn {
            padding: 8px 20px;
            background: transparent;
            color: rgba(255, 255, 255, 0.7);
            border: none;
            border-radius: 20px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Chewy', cursive;
        }
        
        .mode-btn.active {
            background: #ff3366;
            color: white;
        }
        
        .timer {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 1.2rem;
            z-index: 10;
            display: none;
            font-family: 'Chewy', cursive;
        }
        
        .preview-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: none;
            flex-direction: column;
            z-index: 95;
        }
        
        .preview-image {
            width: 100%;
            height: 85%;
            object-fit: contain;
        }
        
        .preview-video {
            width: 100%;
            height: 85%;
            object-fit: contain;
        }
        
        .preview-controls {
            height: 15%;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 0 20px;
            background: rgba(0, 0, 0, 0.8);
        }
        
        .preview-btn {
            padding: 10px 30px;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Chewy', cursive;
        }
        
        .preview-btn.retake {
            background: #333;
            color: white;
        }
        
        .preview-btn.home {
            background: #666;
            color: white;
        }
        
        .preview-btn.download {
            background: #ff3366;
            color: white;
        }
        
        .preview-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .filter-bar {
            position: absolute;
            bottom: 260px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            z-index: 10;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .filter-bar.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .filter-btn {
            padding: 8px 20px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 20px;
            margin: 0 5px;
            font-size: 0.9rem;
            cursor: pointer;
            font-family: 'Chewy', cursive;
        }
        
        .filter-btn.active {
            background: #ff3366;
        }
        
        .brand-text {
            position: absolute;
            z-index: 10;
            font-family: 'Chewy', cursive;
            text-align: center;
            width: 100%;
        }
        
        .top-brand {
            top: 10px;
            font-size: 1.2rem;
        }
        
        .bottom-brand {
            bottom: 130px;
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 首页 -->
        <div class="home-screen" id="homeScreen">
            <div class="logo-container">
                <h1 class="main-title">TEN TOES</h1>
                <h2 class="sub-title">ACADEMY</h2>
            </div>
            
            <h3 class="event-title">ANNUAL CONCERT 2025</h3>
            <p class="event-subtitle">Ten Toes Fun Journey Together</p>
            
            <button class="start-btn" id="startBtn">START</button>
        </div>
        
        <!-- 加载页面 -->
        <div class="loading-screen" id="loadingScreen">
            <div class="loading-spinner"></div>
            <div class="loading-text">加载中...</div>
        </div>
        
        <!-- 相机页面 -->
        <div class="camera-screen" id="cameraScreen">
            <div class="brand-text top-brand">TEN TOES MADE IN CHINA</div>
            
            <div class="camera-preview">
                <img class="preview-bg" id="previewBg" src="background1.png" alt="Background">
                <video class="camera-feed" id="cameraFeed" autoplay playsinline></video>
                <img class="frame-overlay" id="frameOverlay" src="frame1.png" alt="Frame">
                
                <div class="top-controls">
                    <div class="control-btn" id="retakeBtn">
                        <img src="retake.png" alt="Retake">
                    </div>
                    <div class="control-btn" id="homeBtn">
                        <img src="cross.png" alt="Home">
                    </div>
                    <div class="control-btn" id="downloadBtn">
                        <img src="download.png" alt="Download">
                    </div>
                </div>
                
                <div class="timer" id="timer">10s</div>
            </div>
            
            <div class="brand-text bottom-brand">OKKS KOREA AK *</div>
            
            <div class="filter-bar" id="filterBar">
                <button class="filter-btn" data-filter="warm">暖色滤镜</button>
                <button class="filter-btn" data-filter="cool">冷色滤镜</button>
                <button class="filter-btn" data-filter="vintage">复古滤镜</button>
            </div>
            
            <div class="style-selector">
                <div class="style-scroller">
                    <div class="style-button active" data-style="1" style="background-image: url('button1.png')"></div>
                    <div class="style-button" data-style="2" style="background-image: url('button2.png')"></div>
                    <div class="style-button" data-style="3" style="background-image: url('button3.png')"></div>
                    <div class="style-button" data-style="4" style="background-image: url('button4.png')"></div>
                    <div class="style-button" data-style="5" style="background-image: url('button5.png')"></div>
                    <div class="style-button" data-style="6" style="background-image: url('button6.png')"></div>
                    <div class="style-button" data-style="7" style="background-image: url('button7.png')"></div>
                    <div class="style-button" data-style="8" style="background-image: url('button8.png')"></div>
                    <div class="style-button" data-style="9" style="background-image: url('button9.png')"></div>
                    <div class="style-button" data-style="10" style="background-image: url('button10.png')"></div>
                </div>
            </div>
            
            <div class="capture-controls">
                <div class="capture-button" id="captureBtn"></div>
                <div class="mode-bar">
                    <button class="mode-btn active" data-mode="photo">Quiksnap</button>
                    <button class="mode-btn" data-mode="video">10s</button>
                    <button class="mode-btn" id="filterToggle">Filter</button>
                </div>
            </div>
        </div>
        
        <!-- 预览页面 -->
        <div class="preview-screen" id="previewScreen">
            <img class="preview-image" id="previewImage" src="" alt="预览" style="display: none;">
            <video class="preview-video" id="previewVideo" controls style="display: none;"></video>
            
            <div class="preview-controls">
                <button class="preview-btn retake" id="previewRetake">重拍</button>
                <button class="preview-btn home" id="previewHome">首页</button>
                <button class="preview-btn download" id="previewDownload">下载</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 页面元素
            const homeScreen = document.getElementById('homeScreen');
            const loadingScreen = document.getElementById('loadingScreen');
            const cameraScreen = document.getElementById('cameraScreen');
            const previewScreen = document.getElementById('previewScreen');
            const startBtn = document.getElementById('startBtn');
            const captureBtn = document.getElementById('captureBtn');
            const retakeBtn = document.getElementById('retakeBtn');
            const homeBtn = document.getElementById('homeBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const cameraFeed = document.getElementById('cameraFeed');
            const previewBg = document.getElementById('previewBg');
            const frameOverlay = document.getElementById('frameOverlay');
            const previewImage = document.getElementById('previewImage');
            const previewVideo = document.getElementById('previewVideo');
            const previewRetake = document.getElementById('previewRetake');
            const previewHome = document.getElementById('previewHome');
            const previewDownload = document.getElementById('previewDownload');
            const styleButtons = document.querySelectorAll('.style-button');
            const modeButtons = document.querySelectorAll('.mode-btn');
            const filterToggle = document.getElementById('filterToggle');
            const filterBar = document.getElementById('filterBar');
            const filterButtons = document.querySelectorAll('.filter-btn');
            const timer = document.getElementById('timer');
            
            // 状态变量
            let currentMode = 'photo'; // 'photo' or 'video'
            let currentStyle = 1;
            let currentFilter = null;
            let mediaStream = null;
            let mediaRecorder = null;
            let recordedChunks = [];
            let recordingTimer = null;
            let recordingTime = 10;
            
            // 启动应用程序
            startBtn.addEventListener('click', startApp);
            
            function startApp() {
                // 显示加载屏幕
                homeScreen.style.filter = 'blur(10px)';
                loadingScreen.style.opacity = '1';
                loadingScreen.style.pointerEvents = 'all';
                
                // 模拟3秒加载时间
                setTimeout(() => {
                    initCamera();
                }, 3000);
            }
            
            function initCamera() {
                // 请求摄像头权限
                navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: 'user',
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    },
                    audio: false
                })
                .then(stream => {
                    mediaStream = stream;
                    cameraFeed.srcObject = stream;
                    
                    // 隐藏加载屏幕，显示相机屏幕
                    loadingScreen.style.opacity = '0';
                    loadingScreen.style.pointerEvents = 'none';
                    cameraScreen.style.display = 'flex';
                })
                .catch(err => {
                    console.error('摄像头访问失败:', err);
                    alert('无法访问摄像头，请确保您已授予权限');
                    loadingScreen.style.opacity = '0';
                    homeScreen.style.filter = 'none';
                });
            }
            
            // 更新当前样式
            function updateStyle(style) {
                currentStyle = style;
                
                // 更新背景
                previewBg.src = `background${style}.png`;
                
                // 更新边框
                frameOverlay.src = `frame${style}.png`;
                
                // 更新活动按钮
                styleButtons.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.style == style) {
                        btn.classList.add('active');
                    }
                });
            }
            
            // 样式按钮事件
            styleButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    updateStyle(btn.dataset.style);
                });
            });
            
            // 模式切换
            modeButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    // 如果是滤镜按钮，切换滤镜面板
                    if (btn.id === 'filterToggle') {
                        filterBar.classList.toggle('active');
                        return;
                    }
                    
                    // 切换模式
                    modeButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentMode = btn.dataset.mode;
                    
                    // 重置滤镜面板状态
                    filterBar.classList.remove('active');
                });
            });
            
            // 滤镜选择
            filterButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterButtons.forEach(b => b.classList.remove('active'));
                    
                    if (btn.dataset.filter === currentFilter) {
                        // 取消选择当前滤镜
                        currentFilter = null;
                        cameraFeed.style.filter = 'none';
                    } else {
                        // 应用新滤镜
                        btn.classList.add('active');
                        currentFilter = btn.dataset.filter;
                        
                        // 应用滤镜效果（模拟）
                        switch(currentFilter) {
                            case 'warm':
                                cameraFeed.style.filter = 'sepia(0.3) saturate(1.5) brightness(1.1)';
                                break;
                            case 'cool':
                                cameraFeed.style.filter = 'hue-rotate(180deg) saturate(1.2) contrast(1.1)';
                                break;
                            case 'vintage':
                                cameraFeed.style.filter = 'sepia(0.5) contrast(1.2) brightness(0.9)';
                                break;
                        }
                    }
                });
            });
            
            // 拍照/录像控制
            captureBtn.addEventListener('mousedown', startCapture);
            captureBtn.addEventListener('touchstart', startCapture);
            captureBtn.addEventListener('mouseup', stopCapture);
            captureBtn.addEventListener('touchend', stopCapture);
            
            function startCapture(e) {
                e.preventDefault();
                
                if (currentMode === 'video') {
                    // 视频录制
                    captureBtn.classList.add('video-recording');
                    timer.style.display = 'block';
                    timer.textContent = `${recordingTime}s`;
                    
                    // 开始录制
                    recordedChunks = [];
                    mediaRecorder = new MediaRecorder(mediaStream);
                    
                    mediaRecorder.ondataavailable = event => {
                        if (event.data.size > 0) {
                            recordedChunks.push(event.data);
                        }
                    };
                    
                    mediaRecorder.onstop = () => {
                        const blob = new Blob(recordedChunks, { type: 'video/mp4' });
                        const url = URL.createObjectURL(blob);
                        previewVideo.src = url;
                    };
                    
                    mediaRecorder.start();
                    
                    // 设置倒计时
                    let timeLeft = recordingTime;
                    recordingTimer = setInterval(() => {
                        timeLeft--;
                        timer.textContent = `${timeLeft}s`;
                        
                        if (timeLeft <= 0) {
                            stopCapture();
                        }
                    }, 1000);
                }
            }
            
            function stopCapture() {
                if (currentMode === 'video') {
                    // 停止视频录制
                    if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                        mediaRecorder.stop();
                    }
                    
                    captureBtn.classList.remove('video-recording');
                    clearInterval(recordingTimer);
                    timer.style.display = 'none';
                    
                    // 显示预览
                    setTimeout(() => {
                        cameraScreen.style.display = 'none';
                        previewScreen.style.display = 'flex';
                        previewVideo.style.display = 'block';
                        previewImage.style.display = 'none';
                    }, 500);
                } else {
                    // 拍照
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    
                    canvas.width = cameraFeed.videoWidth;
                    canvas.height = cameraFeed.videoHeight;
                    
                    // 应用滤镜效果到canvas（模拟）
                    context.filter = cameraFeed.style.filter;
                    
                    context.drawImage(cameraFeed, 0, 0, canvas.width, canvas.height);
                    
                    // 添加背景和边框
                    const finalCanvas = document.createElement('canvas');
                    finalCanvas.width = canvas.width;
                    finalCanvas.height = canvas.height;
                    const finalCtx = finalCanvas.getContext('2d');
                    
                    // 绘制背景
                    finalCtx.drawImage(previewBg, 0, 0, finalCanvas.width, finalCanvas.height);
                    
                    // 绘制人像
                    finalCtx.drawImage(canvas, 0, 0, finalCanvas.width, finalCanvas.height);
                    
                    // 绘制边框
                    const frameImg = new Image();
                    frameImg.src = frameOverlay.src;
                    frameImg.onload = function() {
                        finalCtx.drawImage(frameImg, 0, 0, finalCanvas.width, finalCanvas.height);
                        
                        previewImage.src = finalCanvas.toDataURL('image/png');
                        
                        // 显示预览
                        cameraScreen.style.display = 'none';
                        previewScreen.style.display = 'flex';
                        previewImage.style.display = 'block';
                        previewVideo.style.display = 'none';
                    };
                }
            }
            
            // 相机控制按钮
            retakeBtn.addEventListener('click', () => {
                // 重拍
                previewScreen.style.display = 'none';
                cameraScreen.style.display = 'flex';
            });
            
            homeBtn.addEventListener('click', () => {
                // 返回首页
                stopMedia();
                cameraScreen.style.display = 'none';
                homeScreen.style.filter = 'none';
            });
            
            downloadBtn.addEventListener('click', () => {
                // 下载（在预览中实现）
                alert('请在预览页面下载');
            });
            
            // 预览控制按钮
            previewRetake.addEventListener('click', () => {
                previewScreen.style.display = 'none';
                cameraScreen.style.display = 'flex';
            });
            
            previewHome.addEventListener('click', () => {
                stopMedia();
                previewScreen.style.display = 'none';
                homeScreen.style.filter = 'none';
            });
            
            previewDownload.addEventListener('click', () => {
                if (previewImage.style.display === 'block') {
                    // 下载图片
                    const link = document.createElement('a');
                    link.href = previewImage.src;
                    link.download = `ten-toes-${new Date().getTime()}.png`;
                    link.click();
                } else {
                    // 下载视频
                    const link = document.createElement('a');
                    link.href = previewVideo.src;
                    link.download = `ten-toes-${new Date().getTime()}.mp4`;
                    link.click();
                }
            });
            
            // 停止媒体流
            function stopMedia() {
                if (mediaStream) {
                    mediaStream.getTracks().forEach(track => track.stop());
                }
            }
            
            // 初始设置
            updateStyle(1);
        });
    </script>
</body>
</html>
